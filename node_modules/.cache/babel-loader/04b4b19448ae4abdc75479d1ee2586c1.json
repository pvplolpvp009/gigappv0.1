{"ast":null,"code":"import _objectSpread from\"C:/Users/pvplo/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/editpallav-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/pvplo/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/editpallav-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/pvplo/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/editpallav-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\pvplo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\editpallav-main\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect,useContext,createContext}from\"react\";import{onAuthStateChanged,getAuth}from\"firebase/auth\";import{getFirestore,doc,getDoc}from\"firebase/firestore\";import firebase_app from\"../firebase/config\";import logout from\"../firebase/auth/logout\";import{jsx as _jsx}from\"react/jsx-runtime\";var auth=getAuth(firebase_app);var db=getFirestore(firebase_app);var AuthContext=/*#__PURE__*/createContext();export var useAuthContext=function useAuthContext(){return useContext(AuthContext);};export var AuthContextProvider=function AuthContextProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),role=_useState6[0],setRole=_useState6[1];useEffect(function(){var unsubscribe=onAuthStateChanged(auth,/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var userDoc,userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=7;break;}_context.next=3;return getDoc(doc(db,\"users\",user.uid));case 3:userDoc=_context.sent;if(userDoc.exists()){userData=userDoc.data();setUser(_objectSpread(_objectSpread({},user),userData));setRole(userData.role||'');// Set the role if it exists\n}else{setUser(user);setRole('');// Set default role if user document does not exist\n}_context.next=9;break;case 7:setUser(null);setRole('');// Reset role when no user is authenticated\ncase 9:setLoading(false);case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());return function(){return unsubscribe();};},[]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user:user,loading:loading,role:role,logout:logout},children:children});};","map":{"version":3,"names":["React","useState","useEffect","useContext","createContext","onAuthStateChanged","getAuth","getFirestore","doc","getDoc","firebase_app","logout","auth","db","AuthContext","useAuthContext","AuthContextProvider","children","user","setUser","loading","setLoading","role","setRole","unsubscribe","uid","userDoc","exists","userData","data"],"sources":["C:/Users/pvplo/OneDrive/Рабочий стол/editpallav-main/src/context/AuthContext.js"],"sourcesContent":["import React, { useState, useEffect, useContext, createContext } from \"react\";\nimport { onAuthStateChanged, getAuth } from \"firebase/auth\";\nimport { getFirestore, doc, getDoc } from \"firebase/firestore\";\nimport firebase_app from \"../firebase/config\";\nimport logout from \"../firebase/auth/logout\";\n\nconst auth = getAuth(firebase_app);\nconst db = getFirestore(firebase_app);\n\nconst AuthContext = createContext();\n\nexport const useAuthContext = () => useContext(AuthContext);\n\nexport const AuthContextProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [role, setRole] = useState('');\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        const userDoc = await getDoc(doc(db, \"users\", user.uid));\n        if (userDoc.exists()) {\n          const userData = userDoc.data();\n          setUser({ ...user, ...userData });\n          setRole(userData.role || ''); // Set the role if it exists\n        } else {\n          setUser(user);\n          setRole(''); // Set default role if user document does not exist\n        }\n      } else {\n        setUser(null);\n        setRole(''); // Reset role when no user is authenticated\n      }\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, loading, role, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"gxBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,UAArC,CAAiDC,aAAjD,KAAsE,OAAtE,CACA,OAASC,kBAAT,CAA6BC,OAA7B,KAA4C,eAA5C,CACA,OAASC,YAAT,CAAuBC,GAAvB,CAA4BC,MAA5B,KAA0C,oBAA1C,CACA,MAAOC,CAAAA,YAAP,KAAyB,oBAAzB,CACA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,C,2CAEA,GAAMC,CAAAA,IAAI,CAAGN,OAAO,CAACI,YAAD,CAApB,CACA,GAAMG,CAAAA,EAAE,CAAGN,YAAY,CAACG,YAAD,CAAvB,CAEA,GAAMI,CAAAA,WAAW,cAAGV,aAAa,EAAjC,CAEA,MAAO,IAAMW,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,SAAMZ,CAAAA,UAAU,CAACW,WAAD,CAAhB,EAAvB,CAEP,MAAO,IAAME,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,CACnD,cAAwBhB,QAAQ,CAAC,IAAD,CAAhC,wCAAOiB,IAAP,eAAaC,OAAb,eACA,eAA8BlB,QAAQ,CAAC,IAAD,CAAtC,yCAAOmB,OAAP,eAAgBC,UAAhB,eACA,eAAwBpB,QAAQ,CAAC,EAAD,CAAhC,yCAAOqB,IAAP,eAAaC,OAAb,eAEArB,SAAS,CAAC,UAAM,CACd,GAAMsB,CAAAA,WAAW,CAAGnB,kBAAkB,CAACO,IAAD,2FAAO,iBAAOM,IAAP,2IACvCA,IADuC,+CAEnBT,CAAAA,MAAM,CAACD,GAAG,CAACK,EAAD,CAAK,OAAL,CAAcK,IAAI,CAACO,GAAnB,CAAJ,CAFa,QAEnCC,OAFmC,eAGzC,GAAIA,OAAO,CAACC,MAAR,EAAJ,CAAsB,CACdC,QADc,CACHF,OAAO,CAACG,IAAR,EADG,CAEpBV,OAAO,gCAAMD,IAAN,EAAeU,QAAf,EAAP,CACAL,OAAO,CAACK,QAAQ,CAACN,IAAT,EAAiB,EAAlB,CAAP,CAA8B;AAC/B,CAJD,IAIO,CACLH,OAAO,CAACD,IAAD,CAAP,CACAK,OAAO,CAAC,EAAD,CAAP,CAAa;AACd,CAVwC,6BAYzCJ,OAAO,CAAC,IAAD,CAAP,CACAI,OAAO,CAAC,EAAD,CAAP,CAAa;AAb4B,OAe3CF,UAAU,CAAC,KAAD,CAAV,CAf2C,uDAAP,gEAAtC,CAkBA,MAAO,kBAAMG,CAAAA,WAAW,EAAjB,EAAP,CACD,CApBQ,CAoBN,EApBM,CAAT,CAsBA,mBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEN,IAAI,CAAJA,IAAF,CAAQE,OAAO,CAAPA,OAAR,CAAiBE,IAAI,CAAJA,IAAjB,CAAuBX,MAAM,CAANA,MAAvB,CAA7B,UACGM,QADH,EADF,CAKD,CAhCM"},"metadata":{},"sourceType":"module"}